import{T as P,h as Q,m as S,o as a,f as c,a as f,u as o,w as k,F as v,Z as A,e as y,b as t,p as C,t as n,g as j,n as T,q as K,j as g,s as V,k as q,O as b,x as E,y as L}from"./app-CAbrd4sj.js";import{_ as M}from"./AuthenticatedLayout-BlSvkPnj.js";import{g as u,n as p,A as z,s as x}from"./AsyncVueSelect-BsR6FDzs.js";import{_ as N}from"./InputError-CEuk3eaO.js";import{_ as Z}from"./SubmitButton-B1sc4iyr.js";import{_ as G}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ApplicationLogo-NrW36AwV.js";const r=d=>(E("data-v-fa49b5df"),d=d(),L(),d),H={class:"flex flex-wrap"},J={class:"w-full px-4"},R={class:"relative -mt-16 flex flex-col min-w-0 break-words w-full mb-6 shadow-lg rounded bg-white"},W={class:"flex lg:flex-row flex-col-reverse shadow-lg"},X={class:"lg:w-4/5 min-h-screen shadow-lg overflow-auto max-h-screen"},Y=r(()=>t("div",{class:"flex flex-row justify-between items-center px-5 mt-5"},[t("div",{class:"text-gray-800"},[t("div",{class:"font-bold text-xl"},"Products")])],-1)),tt={class:"grid grid-cols-2 md:grid-cols-3 xl:grid-cols-4 gap-3 px-4 mt-4 overflow-y-auto h-4/6"},et=["title","onClick"],st=r(()=>t("div",{class:"flex justify-center items-center p-1"},null,-1)),ot={class:"flex pb-1 px-2 text-sm"},nt={class:"flex-grow mr-1 whitespace-normal break-words leading-tight"},lt={key:0,class:"text-xs font-semibold inline-block py-0.5 px-1.5 rounded text-emerald-600 bg-emerald-200"},dt={key:1,class:"text-xs font-semibold inline-block py-0.5 px-1.5 rounded text-red-600 bg-red-200"},it={class:"nowrap font-semibold"},at={class:"lg:w-2/5"},ct={class:"flex flex-row items-center justify-between px-5 mt-5"},rt=r(()=>t("div",{class:"font-bold text-xl"},"Cart",-1)),ut={class:"font-semibold"},mt=["role"],_t={class:"px-5 py-2 overflow-y-auto h-60"},pt=["title"],xt={class:"ml-1 font-semibold text-sm whitespace-normal break-words leading-tight line-clamp-2"},ft=r(()=>t("br",null,null,-1)),bt={class:"flex justify-between"},ht=["onClick"],yt=["onKeyup","value"],vt=["onClick"],gt={class:"font-semibold text-lg w-16 text-center"},wt=["onClick"],St={class:"px-5 mt-1"},kt={class:"pt-2 rounded-md shadow-lg"},Ct={class:"px-4 flex justify-between"},jt=r(()=>t("span",{class:"font-semibold text-sm"},"Subtotal",-1)),Tt={class:"font-bold"},Vt={class:"px-4 flex justify-between"},qt={class:"font-semibold text-sm"},Nt={class:"font-bold"},$t={class:"px-4 flex justify-between"},Dt={key:0,class:"font-semibold text-sm"},Ot={key:1,class:"font-semibold text-sm"},Ft={class:"font-bold"},It={class:"px-4 flex justify-between items-center"},Ut={class:"text-sm flex items-center flex-wrap"},Bt=r(()=>t("span",{class:"font-semibold text-sm mr-1"},"Custom Discount - ",-1)),Pt={class:"flex"},Qt=r(()=>t("option",{value:"fixed"},"=",-1)),At=r(()=>t("option",{value:"percentage"},"%",-1)),Kt=[Qt,At],Et={key:0,class:"font-bold"},Lt={key:1,class:"font-bold"},Mt={class:"border-t-2 mt-3 py-2 px-4 flex items-center justify-between"},zt=r(()=>t("span",{class:"font-semibold text-2xl"},"Total",-1)),Zt={class:"font-bold text-2xl"},Gt={class:"px-5 mt-1"},Ht={class:"rounded-md shadow-lg px-4 py-4"},Jt=r(()=>t("label",{for:"customer",class:"text-stone-600 text-sm font-medium"},"Customer",-1)),Rt=r(()=>t("label",{for:"paid",class:"text-stone-600 text-sm font-medium"},"Pay",-1)),Wt={class:"flex mt-1"},Xt=["value"],Yt=["disabled"],te={key:0,class:"text-xs text-gray-600 mt-1"},ee={class:"px-5 mt-3 mb-4"},se={__name:"Pos",props:{products:Object,carts:Object,cartSubtotal:Number,discountType:String,discount:Number,totalDiscount:Number,tax:Number,totalTax:Number,total:Number,orderPaidByTypes:Object},setup(d){const m=d,e=P({customer_id:null,total:null,paid:null,paid_through:"cash",custom_discount:{discount:0,discount_type:"fixed"}}),w=Q(()=>e.paid_through==="loan");S(m,l=>{e.custom_discount.discount_type==="fixed"?(e.total=l.total-e.custom_discount.discount,e.paid=l.total-e.custom_discount.discount):(e.total=p(l.total-l.cartSubtotal*(e.custom_discount.discount/100)),e.paid=p(l.total-l.cartSubtotal*(e.custom_discount.discount/100)))},{immediate:!0}),S(()=>e.custom_discount,async(l,i)=>{e.custom_discount.discount_type==="fixed"?(e.total=m.total-e.custom_discount.discount,e.paid=m.total-e.custom_discount.discount):(e.total=p(m.total-m.cartSubtotal*(e.custom_discount.discount/100)),e.paid=p(m.total-m.cartSubtotal*(e.custom_discount.discount/100)))},{immediate:!0,deep:!0}),S(w,l=>{l&&(e.paid=0)});const $=l=>{b.post(route("carts.store",l.id),{},{preserveScroll:!0,onSuccess:()=>{x()}})},D=l=>{b.post(route("carts.increment",l.id),{},{preserveScroll:!0,onSuccess:()=>{x()}})},O=l=>{b.post(route("carts.decrement",l.id),{},{preserveScroll:!0,onSuccess:()=>{x()}})},F=(l,i)=>{l.quantity!=i&&b.post(route("carts.update",l.id),{quantity:i},{preserveScroll:!0,onSuccess:()=>{x()}})},I=l=>{b.post(route("carts.delete",l.id),{preserveScroll:!0,onSuccess:()=>{x()}})},U=()=>{b.post(route("carts.delete.all"),{onSuccess:()=>{x()}})},B=()=>{m.carts.total&&e.post(route("orders.store"),{preserveScroll:!0,onSuccess:()=>{x(),e.reset()}})};return(l,i)=>(a(),c(v,null,[f(o(A),{title:"Product"}),f(M,null,{breadcrumb:k(()=>[y(" POS ")]),default:k(()=>[t("div",H,[t("div",J,[t("div",R,[t("div",W,[t("div",X,[Y,t("div",tt,[(a(!0),c(v,null,C(d.products.data,(s,h)=>{var _;return a(),c("div",{key:s.id,role:"button",class:"select-none cursor-pointer transition-shadow rounded-md bg-white shadow hover:shadow-lg border border-gray-200 flex flex-col justify-between",title:s.name,onClick:oe=>$(s)},[st,t("div",ot,[t("p",nt,[s.quantity>0?(a(),c("span",lt,n(s.quantity)+n((_=s.unit_type)==null?void 0:_.symbol),1)):j("",!0),s.quantity<1?(a(),c("span",dt,"0")):j("",!0),y(" "+n(s.name),1)]),t("p",it,n(o(u)())+n(s.selling_price),1)])],8,et)}),128))])]),t("div",at,[t("div",ct,[rt,t("div",ut,[t("span",{onClick:i[0]||(i[0]=s=>d.carts.total>0?U():null),role:d.carts.total>0?"button":null,class:"px-4 py-2 rounded-md bg-red-100 text-red-500"},"Clear("+n(d.carts.total)+")",9,mt)])]),t("div",_t,[(a(!0),c(v,null,C(d.carts.data,s=>{var h;return a(),c("div",{key:s.id,class:T(["flex flex-row justify-between items-center mb-3",s.quantity>s.product.quantity?"bg-red-200":""])},[t("div",{class:"flex flex-row items-center w-2/5",title:s.product.name},[t("span",xt,[y(n(s.product.name)+" ",1),ft,y(" Q: "+n(o(p)(s.product.quantity))+" "+n((h=s.product.unit_type)==null?void 0:h.symbol),1)])],8,pt),t("div",bt,[t("span",{role:"button",onClick:_=>O(s),class:"px-3 py-0.5 rounded-l-md bg-gray-300"},"-",8,ht),t("input",{onKeyup:K(_=>F(s,_.target.value),["enter"]),type:"number",class:"font-semibold border-gray-300 px-0.5 py-0.5 w-10 text-center",value:s.quantity},null,40,yt),t("span",{onClick:_=>D(s),role:"button",class:"px-3 py-0.5 rounded-r-md bg-gray-300"},"+",8,vt)]),t("div",gt,n(o(u)())+n(o(p)(s.quantity*s.product.selling_price)),1),t("i",{onClick:_=>I(s),role:"button",class:"fa fa-trash-alt text-red-500"},null,8,wt)],2)}),128))]),t("div",St,[t("div",kt,[t("div",Ct,[jt,t("span",Tt,n(o(u)())+n(d.cartSubtotal),1)]),t("div",Vt,[t("span",qt,"Sales Tax("+n(d.tax)+"%)",1),t("span",Nt,n(o(u)())+n(d.totalTax),1)]),t("div",$t,[d.discountType==="fixed"?(a(),c("span",Dt,"Discount("+n(o(u)())+n(d.discount)+")",1)):(a(),c("span",Ot,"Discount("+n(d.discount)+"%)",1)),t("span",Ft,"- "+n(o(u)())+n(d.totalDiscount),1)]),t("div",It,[t("div",Ut,[Bt,t("div",Pt,[g(t("select",{"onUpdate:modelValue":i[1]||(i[1]=s=>o(e).custom_discount.discount_type=s),class:"px-3 py-1 w-14 rounded-l-md bg-gray-300 border-none"},Kt,512),[[V,o(e).custom_discount.discount_type]]),g(t("input",{"onUpdate:modelValue":i[2]||(i[2]=s=>o(e).custom_discount.discount=s),type:"number",class:"font-semibold border-gray-300 px-0.5 py-1 w-10 text-center"},null,512),[[q,o(e).custom_discount.discount]])])]),o(e).custom_discount.discount_type==="fixed"?(a(),c("span",Et,"- "+n(o(u)())+n(o(e).custom_discount.discount),1)):(a(),c("span",Lt,"- "+n(o(u)())+n(o(p)(d.cartSubtotal*(o(e).custom_discount.discount/100))),1))]),t("div",Mt,[zt,t("span",Zt,n(o(u)())+n(o(e).total),1)])])]),t("div",Gt,[t("div",Ht,[t("div",null,[Jt,f(z,{modelValue:o(e).customer_id,"onUpdate:modelValue":i[3]||(i[3]=s=>o(e).customer_id=s),class:"my-1",resource:"customers.index",placeholder:"Select Customer"},null,8,["modelValue"]),f(N,{message:o(e).errors.customer_id},null,8,["message"])]),t("div",null,[Rt,t("div",Wt,[g(t("select",{id:"paid_through","onUpdate:modelValue":i[4]||(i[4]=s=>o(e).paid_through=s),class:"w-1/2 rounded-l-md bg-gray-300 border-none px-2 py-2 outline-none focus:outline-none"},[(a(!0),c(v,null,C(d.orderPaidByTypes,(s,h)=>(a(),c("option",{key:h,value:s.value},n(s.label),9,Xt))),128))],512),[[V,o(e).paid_through]]),g(t("input",{id:"paid",placeholder:"Enter paid amount","onUpdate:modelValue":i[5]||(i[5]=s=>o(e).paid=s),disabled:w.value,type:"text",class:"w-full rounded-r-md border border-gray-200 px-2 py-2 shadow-sm outline-none focus:outline-none focus:shadow-outline"},null,8,Yt),[[q,o(e).paid]])]),w.value?(a(),c("p",te,"This sale will be recorded as a customer loan (no cash collected).")):j("",!0),f(N,{message:o(e).errors.paid},null,8,["message"])])])]),t("div",ee,[f(Z,{onClick:B,processing:o(e).processing,class:T(["w-full px-4 py-4 rounded-md shadow-lg text-center bg-emerald-500 text-white font-semibold focus:outline-none",d.carts.total?"":"cursor-not-allowed"])},{default:k(()=>[y("Pay & Print")]),_:1},8,["processing","class"])])])])])])])]),_:1})],64))}},ue=G(se,[["__scopeId","data-v-fa49b5df"]]);export{ue as default};
